<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pastel Spin — 12 Numbers + Modal</title>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ========= Base (Pastel UI vibe) ========= */
    * {
      box-sizing: border-box;
    }

    html {
      font-size: clamp(16px, 0.9vw + 12px, 20px);
    }

    body {
      margin: 0;
      font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #fdf6f8;
      color: #8d7b8d;
      min-height: 100svh;
      display: grid;
      place-items: center;
      padding: clamp(1.5rem, 3vw, 2.5rem);
    }

    :where(button, [role="button"]):focus-visible {
      outline: 3px dashed #b18597;
      outline-offset: 3px;
    }

    /* ========= Card around the wheel ========= */
    .card {
      width: min(860px, 100%);
      background: #fff0f0;
      border: 2px solid #b18597;
      border-radius: 1.2rem;
      box-shadow: 0 0.8em 1.5em rgba(177, 133, 151, .16);
      padding: clamp(1rem, 2vw, 1.5rem);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      border: 2px dashed #b18597;
      border-radius: inherit;
      pointer-events: none;
    }

    /* ========= Wheel container ========= */
    #spin_the_wheel {
      position: relative;
      display: grid;
      place-items: center;
      gap: 1rem;
    }

    #wheel {
      display: block;
      width: 100%;
      height: auto;
      max-width: 720px;
      /* responsive clamp via container width */
      aspect-ratio: 1 / 1;
    }

    /* ========= Spin button (Pastel “badge” style) ========= */
    #spin {
      user-select: none;
      cursor: pointer;
      position: absolute;
      top: 50%;
      left: 50%;
      width: 30%;
      height: 30%;
      margin: -15%;
      display: grid;
      place-items: center;
      text-align: center;

      font-weight: 700;
      font-size: clamp(1rem, 2vw, 1.25rem);
      color: #a192a1;
      background: #fff0f0;
      border: 2px solid #b18597;
      border-radius: 1rem;

      /* pastel shadow “lift” */
      box-shadow: 0 0.5em 0 0 #ffe3e2, 0 0 0 8px currentColor;
      transition: transform .15s cubic-bezier(0, 0, .58, 1), background .15s cubic-bezier(0, 0, .58, 1);
    }

    #spin::after {
      content: "";
      position: absolute;
      top: -22px;
      border: 10px solid transparent;
      border-bottom-color: currentColor;
      border-top: none;
      filter: drop-shadow(0 2px 0 #ffe3e2);
    }

    #spin:active {
      transform: translateY(.4em);
      box-shadow: 0 0 0 0 #ffe3e2, 0 0 0 8px currentColor;
      background: #ffe9e9;
    }

    /* The wheel’s active color drives the ring only (keep center pastel) */
    #spin.pulse {
      animation: pulse 900ms ease-out;
    }

    @keyframes pulse {
      from {
        transform: scale(1);
      }

      40% {
        transform: scale(1.03);
      }

      to {
        transform: scale(1);
      }
    }

    /* ========= Modal ========= */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(177, 133, 151, .35);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      z-index: 100;
    }

    .modal-backdrop.open {
      display: flex;
    }

    .modal {
      width: min(560px, 96vw);
      background: #fff0f0;
      border: 2px solid #b18597;
      border-radius: 1.2rem;
      box-shadow: 0 .8em 1.5em rgba(177, 133, 151, .22);
      padding: clamp(1rem, 2vw, 1.25rem);
      position: relative;
    }

    .modal::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      border: 2px dashed #b18597;
      pointer-events: none;
    }

    .modal h2 {
      margin: 0 0 .25rem;
      color: #8d7b8d;
      font-size: clamp(1.2rem, 2.5vw, 1.6rem);
    }

    .muted {
      color: #9a879a;
      margin: 0 0 .75rem;
    }

    .question {
      color: #8d7b8d;
      font-size: clamp(1rem, 2vw, 1.1rem);
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .actions {
      display: flex;
      gap: .6rem;
      justify-content: flex-end;
      flex-wrap: wrap;
    }

    .btn {
      appearance: none;
      border: 0;
      cursor: pointer;
      font: inherit;
      font-weight: 700;
      border-radius: .9rem;
      padding: .8rem 1rem;
      position: relative;
      background: #fff0f0;
      color: #a192a1;
      border: 2px solid #b18597;
      box-shadow: 0 .45em 0 0 #ffe3e2;
      transition: transform .15s cubic-bezier(0, 0, .58, 1), background .15s;
    }

    .btn:active {
      transform: translateY(.35em);
      box-shadow: 0 0 0 #ffe3e2;
      background: #ffe9e9;
    }

    .btn.primary {
      background: #f9c4d2;
    }

    .btn.primary:active {
      background: #f6b5c7;
    }

    /* ========= Decorative blobs (subtle) ========= */
    .blob,
    .sparkle {
      position: absolute;
      pointer-events: none;
      border-radius: 50%;
      filter: blur(28px);
      opacity: .55;
    }

    .blob {
      width: clamp(200px, 24vw, 380px);
      height: clamp(200px, 24vw, 380px);
      background: #ffe3e8;
      border: 2px solid #b18597;
      right: -60px;
      top: -60px;
      transform: rotate(6deg);
      box-shadow: 0 .6em 0 0 #ffe3e2;
      opacity: .35;
    }

    .sparkle {
      width: clamp(160px, 18vw, 260px);
      height: clamp(160px, 18vw, 260px);
      background: #f9c4d2;
      left: -50px;
      bottom: -50px;
    }
  </style>
</head>

<body>
  <div class="card">
    <span class="sparkle" aria-hidden="true"></span>
    <span class="blob" aria-hidden="true"></span>

    <div id="spin_the_wheel" aria-live="polite">
      <canvas id="wheel" width="720" height="720" aria-label="Wheel with numbers 1 to 12"></canvas>
      <div id="spin" role="button" aria-label="Spin the wheel" title="Spin the wheel">SPIN</div>
    </div>
  </div>

  <!-- Modal -->
  <div id="resultModal" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h2 id="modalTitle">Your number: <span id="pickedNumber">—</span></h2>
      <p class="muted">Answer the question below, then close.</p>
      <div class="question" id="questionText">…</div>
      <div class="actions">
        <button id="closeModal" class="btn primary">Close</button>
        <button id="spinAgain" class="btn">Spin Again</button>
      </div>
    </div>
  </div>

  <script>
    // --- 12 numbered sectors ---
    const sectors = Array.from({ length: 12 }, (_, i) => {
      const even = i % 2 === 0;
      return {
        color: even ? "#FFBC03" : "#FF5A10", // keeps wedge contrast
        text: "#333333",
        label: String(i + 1)
      };
    });

    const questions = [
      "Name one thing you’re grateful for today.",
      "What’s a small goal you’ll finish this week?",
      "Share a fun fact you learned recently.",
      "Who would you like to thank and why?",
      "What’s your favorite way to relax?",
      "Describe a challenge you overcame.",
      "What new skill would you like to learn?",
      "What made you smile today?",
      "Name a book or movie you recommend.",
      "What habit are you building this month?",
      "What’s one place you want to visit?",
      "What’s a song that boosts your mood?"
    ];

    // --- Tiny event bus ---
    const events = {
      listeners: {},
      addListener(event, fn) { (this.listeners[event] ||= []).push(fn); },
      fire(event, ...args) { (this.listeners[event] || []).forEach(fn => fn(...args)); }
    };

    const rand = (m, M) => Math.random() * (M - m) + m;
    const tot = sectors.length;

    const spinEl = document.querySelector("#spin");
    const canvas = document.querySelector("#wheel");
    const ctx = canvas.getContext("2d");

    const dia = ctx.canvas.width;
    const rad = dia / 2;
    const PI = Math.PI;
    const TAU = 2 * PI;
    const arc = TAU / sectors.length;

    const friction = 0.991;
    let angVel = 0; // Angular velocity
    let ang = 0;    // Angle in radians
    let spinButtonClicked = false;

    const getIndex = () => Math.floor(tot - (ang / TAU) * tot) % tot;

    function drawSector(sector, i) {
      const a = arc * i;
      ctx.save();

      // Wedge
      ctx.beginPath();
      ctx.fillStyle = sector.color;
      ctx.moveTo(rad, rad);
      ctx.arc(rad, rad, rad, a, a + arc);
      ctx.lineTo(rad, rad);
      ctx.fill();

      // Number
      ctx.translate(rad, rad);
      ctx.rotate(a + arc / 2);
      ctx.textAlign = "right";
      ctx.fillStyle = sector.text;
      ctx.font = "700 46px 'Poppins', sans-serif";
      ctx.fillText(sector.label, rad - 20, 16);

      ctx.restore();
    }

    function rotate() {
      const sector = sectors[getIndex()];
      canvas.style.transform = `rotate(${ang - PI / 2}rad)`;

      // Center button shows current sector label while spinning
      spinEl.textContent = !angVel ? "SPIN" : sector.label;

      // Keep center pastel; add a little pulse when sector changes
      if (angVel) {
        spinEl.classList.add("pulse");
        clearTimeout(rotate._t);
        rotate._t = setTimeout(() => spinEl.classList.remove("pulse"), 180);
      }
    }

    function frame() {
      if (!angVel && spinButtonClicked) {
        const finalIdx = getIndex();
        const finalSector = sectors[finalIdx];
        events.fire("spinEnd", finalIdx, finalSector);
        spinButtonClicked = false;
        return;
      }
      angVel *= friction;
      if (angVel < 0.002) angVel = 0;
      ang = (ang + angVel) % TAU;
      rotate();
    }

    function engine() {
      frame();
      requestAnimationFrame(engine);
    }

    function init() {
      sectors.forEach(drawSector);
      rotate();
      engine();
      spinEl.addEventListener("click", () => {
        if (!angVel) angVel = rand(0.25, 0.45);
        spinButtonClicked = true;
      });
    }

    // --- Modal helpers ---
    const modal = document.getElementById("resultModal");
    const pickedNumberEl = document.getElementById("pickedNumber");
    const questionTextEl = document.getElementById("questionText");
    const closeBtn = document.getElementById("closeModal");
    const spinAgainBtn = document.getElementById("spinAgain");

    function openModal(number, question) {
      pickedNumberEl.textContent = number;
      questionTextEl.textContent = question;
      modal.classList.add("open");
      modal.setAttribute("aria-hidden", "false");
    }
    function closeModal() {
      modal.classList.remove("open");
      modal.setAttribute("aria-hidden", "true");
    }

    closeBtn.addEventListener("click", closeModal);
    spinAgainBtn.addEventListener("click", () => {
      closeModal();
      if (!angVel) {
        angVel = rand(0.25, 0.45);
        spinButtonClicked = true;
      }
    });
    modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });
    window.addEventListener("keydown", (e) => { if (e.key === "Escape") closeModal(); });

    // --- Start ---
    init();

    // Show modal when the spin ends
    events.addListener("spinEnd", (idx, sector) => {
      const pickedNumber = Number(sector.label);
      const question = questions[(pickedNumber - 1) % 12] || "No question set.";
      openModal(pickedNumber, question);
    });
  </script>
</body>

</html>
